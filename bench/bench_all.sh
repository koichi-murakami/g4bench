#!/bin/sh -
# ======================================================================
#  G4Bench benchmark (single thread)
# ======================================================================
export LANG=C

# ======================================================================
# run parameters
# ======================================================================
export G4DATA=/opt/geant4/data

run_ecal=1
run_hcal=1
run_vgeo_x18=1
run_vgeo_e20=1
run_vgeo_p200=1

# ======================================================================
# functions
# ======================================================================
check_error() {
  if [ $? -ne 0 ]; then
    exit -1
  fi
}

show_line() {
echo "========================================================================"
}

# ======================================================================
# main
# ======================================================================
if [ -d run ]; then
  echo "[ERROR] run directory already exists."
  exit -1
fi
mkdir run
cd run

show_line
echo " Execute G4Bench tests"
show_line

# ======================================================================
if [ ${run_ecal} = 1 ]; then
  export G4BENCH=../../ecal
  ../ecal_e1000.sh
  mv g4bench.json ecal.json
fi

# ======================================================================
if [ ${run_hcal} = 1 ]; then
  export G4BENCH=../../hcal
  ../hcal_p10.sh
  mv g4bench.json hcal.json
fi

# ======================================================================
export G4BENCH=../../vgeo
if [ ${run_vgeo_x18} = 1 ]; then
  ../vgeo_x18.sh
  mv g4bench.json vgeo_x18.json
fi

# ======================================================================
if [ ${run_vgeo_e20} = 1 ]; then
  ../vgeo_e20.sh
  mv g4bench.json vgeo_e20.json
fi

# ======================================================================
if [ ${run_vgeo_p200} = 1 ]; then
  ../vgeo_p200.sh
  mv g4bench.json vgeo_p200.json
fi

# ======================================================================
cd ..
exit $?
